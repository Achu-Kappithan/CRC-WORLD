 <%- include("../layouts/user/header.ejs") %>
<style>
.stock-status {
  font-weight: bold;
}

.in-stock {
  color: green;
  font-size: medium;
}

.limited-stock {
  color: orange;
  font-size: medium;
}

.out-of-stock {
  color: red;
  font-size: medium;
}

        .tabs-listing {
            border-bottom: 1px solid #e8e8e8;
            margin: 20px 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        .product-tabs {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            gap: 40px;
        }

        .product-tabs li {
            margin: 0;
            padding: 0;
        }

        .product-tabs .tablink {
            display: inline-block;
            padding: 15px 0;
            color: #333;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            position: relative;
            transition: color 0.3s;
        }

        .product-tabs .tablink:hover {
            color: #000;
        }

        .product-tabs .tablink::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #000;
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        .product-tabs li.active .tablink::after {
            transform: scaleX(1);
        }

</style>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/elevatezoom/3.0.8/jquery.elevatezoom.min.js"></script>

        <!--Body Content-->
        <div id="page-content">
            <!--MainContent-->
            <div id="MainContent" class="main-content" role="main">
                <!--Breadcrumb-->
                <div class="bredcrumbWrap">
                    <div class="container-fluid breadcrumbs">
                        <a href="index.html" title="Back to the home page">Home</a><span aria-hidden="true">›</span><span>Product Layout Style3</span>
                    </div>
                </div>
                <!--End Breadcrumb-->
                
                <div id="ProductSection-product-template" class="product-template__container prstyle3 container-fluid">
                    <!--#ProductSection-product-template-->
                    <div class="product-single product-single-1">
                    	<div class="left-content-product">
                            <div class="row">
                                <div class="col-lg-6 col-md-6 col-sm-12 col-12">
                                    <div class="product-details-img product-single__photos bottom">
                                        <div class="zoompro-wrap product-zoom-right pl-20">
                                            <div style="height: 500px; width: 500px;" class="zoompro-span">
                                                <img id="main-zoom-image" class="blur-up lazyload zoompro"
                                                    zoomimage="/assets/uploads/product/<%= productdata.productimage[0] %>"
                                                    src="/assets/uploads/product/<%= productdata.productimage[0] %>" />
                                            </div>
                                            <div class="product-labels">
                                                <span class="lbl on-sale">Sale</span>
                                                <span class="lbl pr-label1">new</span>
                                            </div>
                                        </div>
                                        
                                        <div class="product-thumb product-thumb-1">
                                            <div id="image-gallery" class="product-dec-slider-1 product-tab-left">
                                                <% productdata.productimage.forEach((image, index) => { %>
                                                    <a href="" class="thumb-image" 
                                                      data-image="/assets/uploads/product/<%= image %>"
                                                      data-zoom-image="/assets/uploads/product/<%= image %>">
                                                     <img class="blur-up lazyload" 
                                                     src="/assets/uploads/product/<%= image %>" 
                                                       alt="Thumbnail Image" />
                                                    </a>
                                                <% }) %>
                                            </div>
                                        </div>                                        
                                        <div class="lightboximages">
                                        </div>
            
                                    </div>
                                </div>
                                <div class="col-lg-6 col-md-6 col-sm-12 col-12">
                                    <div class="product-single__meta">
                                        <h1 class="product-single__title"><%= productdata.productname %></h1>
                                        <div class="product-nav clearfix">
                                          <a href="#" class="next" title="Next"><i class="fa fa-angle-right" aria-hidden="true"></i></a>
                                        </div>
                                        <div class="prInfoRow">
                                          <div class="product-stock">
                                            <span id="stock-status"></span>
                                            <p>Stock : <span id="product-stock"><%= productdata.sizes[0].stock %></span></p>
                                          </div>
                                          <div class="product-sku">SKU: <span class="variant-sku">19115-rdxs</span></div>
                                          <div class="product-review">
                                            <a class="reviewLink" href="#tab2">
                                              <i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i>
                                              <i class="font-13 fa fa-star-o"></i><i class="font-13 fa fa-star-o"></i>
                                              <span class="spr-badge-caption">6 reviews</span>
                                            </a>
                                          </div>
                                        </div>
                                         <p class="product-single__price product-single__price-product-template">
                                            <span class="visually-hidden">Regular price</span>
                                            <s id="ComparePrice-product-template"><span class="money"><%= productdata.sizes[2].Actualprice%></span></s>
                                            <span class="product-price__price product-price__price-product-template product-price__sale product-price__sale--single">
                                                <span id="ProductPrice-product-template">₹<span class="money" id="product-price"><%= productdata.sizes[0].Salesprice %> </span></span>
                                            </span>
                                            <span class="discount-badge"> <span class="devider">|</span>&nbsp;
                                                <span>You Save</span>
                                                <span id="SaveAmount-product-template" class="product-single__save-amount">
                                                <span class="money">$100.00</span>
                                                </span>
                                                <span class="off">(<span>16</span>%)</span>
                                            </span>  
                                        </p>
                                        <div  class="product-single__description rte">
                                        <ul>
                                            <li><h3>Product Detailas</h3></li>
                                            <% if (productdata.productdescription) { %>
                                                <ul>
                                                    <% productdata.productdescription.split('\n').forEach(function(point) { %>
                                                        <% if (point.trim()) { %>
                                                            <li><%= point.trim() %></li>
                                                        <% } %>
                                                    <% }) %>
                                                </ul>
                                            <% } %>
                                        </ul>
                                    </div>
                                    <div id="quantity_message">Hurry! Only  <span class="items">4</span>  left in stock.</div>
                                    <form method="post" action="http://annimexweb.com/cart/add" id="product_form_10508262282" accept-charset="UTF-8" class="product-form product-form-product-template hidedropdown" enctype="multipart/form-data">
                                        <div class="swatch clearfix swatch-0 option1" data-option-index="0">
                                        </div>
                                        <div class="swatch clearfix swatch-1 option2" data-option-index="1">

                                            <div class="product-form__item">
                                                <label class="header">Size: <span class="slVariant">Select Size</span></label>
                                                <% for (let i = 0; i < productdata.sizes.length; i++) { %>
                                                  <div data-value="<%= productdata.sizes[i].size %>" class="swatch-element available">
                                                    <input
                                                      class="swatchInput"
                                                      id="swatch-<%= i %>-<%= productdata.sizes[i].size %>"
                                                      type="radio"
                                                      name="size-option"
                                                      value="<%= productdata.sizes[i].size %>"
                                                      data-price="<%= productdata.sizes[i].Salesprice %>"
                                                      data-stock="<%= productdata.sizes[i].stock %>"
                                                      onchange="handleSizeChange('<%= productdata.sizes[i]._id %>', this)"
                                                      <% if (i === 0) { %> checked <% } %> 
                                                    >
                                                    <label id="sizelabel" class="swatchLbl small flat" for="swatch-<%= i %>-<%= productdata.sizes[i].size %>" title="<%= productdata.sizes[i].size %>">
                                                      <%= productdata.sizes[i].size %>
                                                    </label>
                                                  </div>
                                                <% } %>
                                            </div>
                                        </div>
                                      </form> 
                                        <!-- Product Action -->
                                        <div class="product-action clearfix">
                                            <div class="product-form__item--quantity">
                                                <div style="text-align: center;">
                                                    <div style="display: flex; align-items: center; justify-content: center; gap: 20px;">
                                                        <button id="decrementBtn" style="font-size: 24px; width: 40px; height: 40px; background-color: #ff4d4d; color: white; border: none; border-radius: 50%; cursor: pointer;">-</button>
                                                        <span id="countDisplay" style="font-size: 24px; font-weight: bold; min-width: 50px; text-align: center;">0</span>
                                                        <button id="incrementBtn" style="font-size: 24px; width: 40px; height: 40px; background-color: #4CAF50; color: white; border: none; border-radius: 50%; cursor: pointer;">+</button>
                                                    </div>
                                                </div>
                                                                                             
                                            </div>  
                                                                      
                                            <div class="product-form__item--submit">
                                                <button id="addToCart_<%= productdata._id%>" class="btn btn-addto-cart" tabindex="0" data-product-id="<%= productdata._id%>">
                                                    Add To Cart
                                                </button>

                                            </div>
                                            <div class="shopify-payment-button" data-shopify="payment-button">
                                                <button type="button" class="shopify-payment-button__button shopify-payment-button__button--unbranded">Buy it now</button>
                                            </div>
                                        </div>
                                        <!-- End Product Action -->
                                    
                                        <div class="display-table shareRow">
                                            <div class="display-table-cell medium-up--one-third">
                                                <div class="wishlist-btn">
                                                    <a class="wishlist add-to-wishlist" href="#" title="Add to Wishlist"><i class="icon anm anm-heart-l" aria-hidden="true"></i> <span>Add to Wishlist</span></a>
                                                </div>
                                            </div>
                                            <div class="display-table-cell text-right">
                                                <div class="social-sharing">
                                                    <a target="_blank" href="#" class="btn btn--small btn--secondary btn--share share-facebook" title="Share on Facebook">
                                                        <i class="fa fa-facebook-square" aria-hidden="true"></i> <span class="share-title" aria-hidden="true">Share</span>
                                                    </a>
                                                    <a target="_blank" href="#" class="btn btn--small btn--secondary btn--share share-twitter" title="Tweet on Twitter">
                                                        <i class="fa fa-twitter" aria-hidden="true"></i> <span class="share-title" aria-hidden="true">Tweet</span>
                                                    </a>
                                                    <a href="#" title="Share on google+" class="btn btn--small btn--secondary btn--share" >
                                                        <i class="fa fa-google-plus" aria-hidden="true"></i> <span class="share-title" aria-hidden="true">Google+</span>
                                                    </a>
                                                    <a target="_blank" href="#" class="btn btn--small btn--secondary btn--share share-pinterest" title="Pin on Pinterest">
                                                        <i class="fa fa-pinterest" aria-hidden="true"></i> <span class="share-title" aria-hidden="true">Pin it</span>
                                                    </a>
                                                    <a href="#" class="btn btn--small btn--secondary btn--share share-pinterest" title="Share by Email" target="_blank">
                                                        <i class="fa fa-envelope" aria-hidden="true"></i> <span class="share-title" aria-hidden="true">Email</span>
                                                    </a>
                                                 </div>
                                            </div>
                                        </div>
                                    <div class="product-info">
                                      <p class="product-type"><span class="lbl">Product Type:</span> <a href="http://annimexweb.com/collections/types?q=Women%27s" title="Women's">Women's</a></p>
                                      <p class="product-cat"> <span class="lbl">Collections: </span><a href="http://annimexweb.com/collections/notifications" title="">Product Notifications</a> <a href="http://annimexweb.com/collections/women" title="">Women</a> </p>
                                    </div>
                                </div>
                                </div>
                                <!--Product Tabs-->
                                <div class="tabs-listing">
                                    <ul class="product-tabs">
                                        <li rel="tab2"><a class="tablink">Product Reviews</a></li>
                                        <li rel="tab4"><a class="tablink">Shipping &amp; Returns</a></li>
                                    </ul>
                                    <div class="tab-container">
                                        
                                        <div id="tab2" class="tab-content">
                                            <div id="shopify-product-reviews">
                                                <div class="spr-container">
                                                    <div class="spr-header clearfix">
                                                        <div class="spr-summary">
                                                            <span class="product-review"><a class="reviewLink"><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star-o"></i><i class="font-13 fa fa-star-o"></i> </a><span class="spr-summary-actions-togglereviews">Based on 6 reviews456</span></span>
                                                            <span class="spr-summary-actions">
                                                                <a href="#" class="spr-summary-actions-newreview btn">Write a review</a>
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <div class="spr-content">
                                                        <div class="spr-form clearfix">
                                                            <form method="post" action="#" id="new-review-form" class="new-review-form">
                                                                <h3 class="spr-form-title">Write a review</h3>
                                                                <fieldset class="spr-form-contact">
                                                                    <div class="spr-form-contact-name">
                                                                      <label class="spr-form-label" for="review_author_10508262282">Name</label>
                                                                      <input class="spr-form-input spr-form-input-text " id="review_author_10508262282" type="text" name="review[author]" value="" placeholder="Enter your name">
                                                                    </div>
                                                                    <div class="spr-form-contact-email">
                                                                      <label class="spr-form-label" for="review_email_10508262282">Email</label>
                                                                      <input class="spr-form-input spr-form-input-email " id="review_email_10508262282" type="email" name="review[email]" value="" placeholder="john.smith@example.com">
                                                                    </div>
                                                                </fieldset>
                                                                <fieldset class="spr-form-review">
                                                                  <div class="spr-form-review-rating">
                                                                    <label class="spr-form-label">Rating</label>
                                                                    <div class="spr-form-input spr-starrating">
                                                                      <div class="product-review"><a class="reviewLink" href="#"><i class="fa fa-star-o"></i><i class="font-13 fa fa-star-o"></i><i class="font-13 fa fa-star-o"></i><i class="font-13 fa fa-star-o"></i><i class="font-13 fa fa-star-o"></i></a></div>
                                                                    </div>
                                                                  </div>
                                                            
                                                                  <div class="spr-form-review-title">
                                                                    <label class="spr-form-label" for="review_title_10508262282">Review Title</label>
                                                                    <input class="spr-form-input spr-form-input-text " id="review_title_10508262282" type="text" name="review[title]" value="" placeholder="Give your review a title">
                                                                  </div>
                                                            
                                                                  <div class="spr-form-review-body">
                                                                    <label class="spr-form-label" for="review_body_10508262282">Body of Review <span class="spr-form-review-body-charactersremaining">(1500)</span></label>
                                                                    <div class="spr-form-input">
                                                                      <textarea class="spr-form-input spr-form-input-textarea " id="review_body_10508262282" data-product-id="10508262282" name="review[body]" rows="10" placeholder="Write your comments here"></textarea>
                                                                    </div>
                                                                  </div>
                                                                </fieldset>
                                                                <fieldset class="spr-form-actions">
                                                                    <input type="submit" class="spr-button spr-button-primary button button-primary btn btn-primary" value="Submit Review">
                                                                </fieldset>
                                                            </form>
                                                        </div>
                                                        <div class="spr-reviews">
                                                            <div class="spr-review">
                                                                <div class="spr-review-header">
                                                                    <span class="product-review spr-starratings spr-review-header-starratings"><span class="reviewLink"><i class="fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i></span></span>
                                                                    <h3 class="spr-review-header-title">Lorem ipsum dolor sit amet</h3>
                                                                    <span class="spr-review-header-byline"><strong>dsacc</strong> on <strong>Apr 09, 2019</strong></span>
                                                                </div>
                                                                <div class="spr-review-content">
                                                                    <p class="spr-review-content-body">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                                                                </div>
                                                            </div>
                                                            <div class="spr-review">
                                                              <div class="spr-review-header">
                                                                <span class="product-review spr-starratings spr-review-header-starratings"><span class="reviewLink"><i class="fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i></span></span>
                                                                <h3 class="spr-review-header-title">Lorem Ipsum is simply dummy text of the printing</h3>
                                                                <span class="spr-review-header-byline"><strong>larrydude</strong> on <strong>Dec 30, 2018</strong></span>
                                                              </div>
                                                        
                                                              <div class="spr-review-content">
                                                                <p class="spr-review-content-body"><br><br>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled.<br><br>
                                                                    Lorem Ipsum is simply dummy text of the printing and typesetting industry.<br><br>Lorem Ipsum is simply dummy text of the printing and typesetting industry.<br>
                                                                </p>
                                                              </div>
                                                            </div>
                                                            <div class="spr-review">
                                                              <div class="spr-review-header">
                                                                <span class="product-review spr-starratings spr-review-header-starratings"><span class="reviewLink"><i class="fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i><i class="font-13 fa fa-star"></i></span></span>
                                                                <h3 class="spr-review-header-title">Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit...</h3>
                                                                <span class="spr-review-header-byline"><strong>quoctri1905</strong> on <strong>Dec 30, 2018</strong></span>
                                                              </div>
                                                        
                                                              <div class="spr-review-content">
                                                                <p class="spr-review-content-body">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled.<br>
                                                                <br>Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p>
                                                              </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                            </div>
                                        
                                        <div id="tab4" class="tab-content">
                                            <h4>Returns Policy</h4>
                                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce eros justo, accumsan non dui sit amet. Phasellus semper volutpat mi sed imperdiet. Ut odio lectus, vulputate non ex non, mattis sollicitudin purus. Mauris consequat justo a enim interdum, in consequat dolor accumsan. Nulla iaculis diam purus, ut vehicula leo efficitur at.</p>
                                            <p>Interdum et malesuada fames ac ante ipsum primis in faucibus. In blandit nunc enim, sit amet pharetra erat aliquet ac.</p>
                                            <h4>Shipping</h4>
                                            <p>Pellentesque ultrices ut sem sit amet lacinia. Sed nisi dui, ultrices ut turpis pulvinar. Sed fringilla ex eget lorem consectetur, consectetur blandit lacus varius. Duis vel scelerisque elit, et vestibulum metus.  Integer sit amet tincidunt tortor. Ut lacinia ullamcorper massa, a fermentum arcu vehicula ut. Ut efficitur faucibus dui Nullam tristique dolor eget turpis consequat varius. Quisque a interdum augue. Nam ut nibh mauris.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    	<!--End-product-single-->
                        <!--Product Sidebar-->
                        <div class="prSidebar sidebar-product">
                    		<div class="col-lg-12 col-md-12 col-sm-12 col-12">

                                <div class="related-product grid-products">
                                	<header class="section-header">
                                        <h2 class="section-header__title text-center h2"><span>Related Products</span></h2>
                                        <p class="sub-heading">You can stop autoplay, increase/decrease aniamtion speed and number of grid to show and products from store admin.</p>
                                    </header>
                                    <div class="grid">
                                        <% relatedproducts.forEach(item=>{ %>
                                        <div class="grid__item">
                                          <div class="mini-list-item">
                                            <div class="mini-view_image">
                                                <a class="grid-view-item__link" href="#">
                                                    <img class="grid-view-item__image" src="/assets/uploads/product/<%= item.productimage[0] %>" alt="">
                                                </a>
                                            </div>
                                            <div class="details">
                                            	<a class="grid-view-item__title" href="#"><%= item.productname %></a>
                                                <% let price = item.sizes.find(size => size.Salesprice > 0)?.Salesprice %>
                                              	<div class="grid-view-item__meta"><span class="product-price__price"><span class="money"></span><%= price %></span></div>
                                                <div class="product-review">
                                                    <i class="font-13 fa fa-star"></i>
                                                    <i class="font-13 fa fa-star"></i>
                                                    <i class="font-13 fa fa-star"></i>
                                                    <i class="font-13 fa fa-star"></i>
                                                    <i class="font-13 fa fa-star"></i>
                                                </div>
                                            </div>
                                          </div>
                                        </div>
                                        <% }) %>
                                     </div>
                                </div>
                                <!--Product Feature-->

                                <div class="prFeatures">
                                    <div class="row">
                                        <div class="feature">
                                            <img src="assets/images/credit-card.png" alt="Safe Payment" title="Safe Payment" />
                                            <div class="details"><h5>Safe Payment</h5>Pay with the world's most payment methods.</div>
                                        </div>
                                        <div class="feature">
                                            <img src="assets/images/shield.png" alt="Confidence" title="Confidence" />
                                            <div class="details"><h5>Confidence</h5>Protection covers your purchase and personal data.</div>
                                        </div>
                                        <div class="feature">
                                            <img src="assets/images/worldwide.png" alt="Worldwide Delivery" title="Worldwide Delivery" />
                                            <div class="details"><h5>Worldwide Delivery</h5>FREE &amp; fast shipping to over 200+ countries &amp; regions.</div>
                                        </div>
                                        <div class="feature">
                                            <img src="assets/images/phone-call.png" alt="Hotline" title="Hotline" />
                                            <div class="details"><h5>Hotline</h5>Talk to help line for your question on 4141 456 789, 4125 666 888</div>
                                        </div>
                                    </div>
                                </div>
                                <!--End Product Feature-->

                               	<!--End Recently Viewed Product-->
                            </div>
                        </div>
                        <!--Product Sidebar-->
                    </div>
                	<!--#ProductSection-product-template-->
            	</div>
            <!--MainContent-->
        </div>
    	<!--End Body Content-->

        


<%- include("../layouts/user/footer.ejs") %> 


<script>

    // product zoom

    $(document).ready(function() {
    function initZoom() {
        $('#main-zoom-image').elevateZoom({
            zoomType: "lens",
            lensShape: "round",
            lensSize: 200,
            scrollZoom: true
        });
    }
    initZoom();

    $('#image-gallery').on('click', 'a.thumb-image', function(e) {
        e.preventDefault();

        var newImage = $(this).attr('data-image');
        var newZoomImage = $(this).attr('data-zoom-image');
        console.log("neq",newImage)
        console.log("zoom",newZoomImage)

        $('#main-zoom-image').attr('src', newImage);
        $('#main-zoom-image').attr('zoomimage', newZoomImage);

        // $('.zoomContainer').remove();
        // $('#main-zoom-image').removeData('elevateZoom');

        initZoom();
    });
});


  function handleSizeChange(sizeId, inputElement) {
      const selectedSize = inputElement.value;
      console.log("Selected Size:", selectedSize);

      updateProductDetails(sizeId);
  }

  function updateProductDetails(sizeId) {
      fetch(`/get-size-details?id=${sizeId}`)
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            document.getElementById('product-price').textContent = data.size.Salesprice;
            document.getElementById('product-stock').textContent = data.size.stock;
  
            const stockStatusElement = document.getElementById('stock-status');
            const stock = data.size.stock;
  
            if (stock > 5) {
              stockStatusElement.textContent = 'In Stock';
              stockStatusElement.className = 'stock-status in-stock';
            } else if (stock > 0 && stock <= 5) {
              stockStatusElement.textContent = 'Limited Stock';
              stockStatusElement.className = 'stock-status limited-stock';
            } else {
              stockStatusElement.textContent = 'Out of Stock';
              stockStatusElement.className = 'stock-status out-of-stock';
            }
          } else {
            alert('Failed to fetch size details. Please try again.');
          }
        })
        .catch(error => console.error('Error fetching size details:', error));
  }

  window.onload = function() {
      const defaultSizeId = '<%= productdata.sizes[0]._id %>';  
      updateProductDetails(defaultSizeId);  
  };





  document.querySelectorAll("[id^='addToCart_']").forEach(button => {
  button.addEventListener("click", function() {
    const productId = this.dataset.productId;
    const priceElement = document.getElementById("product-price");
    const Salesprice = priceElement.textContent;
    const countDisplay = document.getElementById('countDisplay');
    const quantity = parseInt(countDisplay.textContent);
    const stockElement = document.getElementById("product-stock");
    const stock = parseInt(stockElement.textContent);

    const selectedSizeRadio = document.querySelector('input[name="size-option"]:checked');
    const Cartsize = selectedSizeRadio ? selectedSizeRadio.value : null;

    console.log("this is the cart size",Cartsize)

    if (!Cartsize) {
      Swal.fire({
        icon: 'error',
        title: 'Oops...',
        text: 'Please select a size before adding to cart!',
        toast: true,
          background: "black",
            color:"white",
            position: "top-end",
            showConfirmButton: false,
            timerProgressBar: true,
            timer: 3000,
            customClass: {
           popup: 'custom-toast'
    },
    didOpen: () => {
        const swalPopup = document.querySelector('.custom-toast');
        swalPopup.style.marginTop = '70px';  
        swalPopup.style.marginRight = '15px'; 
    }

      });
      return;  
    }

    console.log("This is the selected size:", Cartsize);

    fetch("/addto_cart", {
      method: "POST",
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ productId, quantity, Salesprice, stock, Cartsize }),
    })
    .then(response => response.json())
    .then(data => {
      Swal.fire({
        icon: data.alertType || 'success', 
        title: data.alertTitle || 'Success',
        text: data.alertText || data.message,
        toast: true,
          background: "black",
            color:"white",
            position: "top-end",
            showConfirmButton: false,
            timerProgressBar: true,
            timer: 3000,
            customClass: {
           popup: 'custom-toast'
    },
    didOpen: () => {
        const swalPopup = document.querySelector('.custom-toast');
        swalPopup.style.marginTop = '70px';  
        swalPopup.style.marginRight = '15px'; 
    }

      });
    })
    .catch(error => {
      Swal.fire({
        icon: 'error',
        title: 'Oops...',
        text: 'Something went wrong!',
        toast: true,
            position: "top-end",
            showConfirmButton: false,
            timerProgressBar: true,
            timer: 3000,
            customClass: {
           popup: 'custom-toast'
    },
    didOpen: () => {
        const swalPopup = document.querySelector('.custom-toast');
        swalPopup.style.marginTop = '70px';  
        swalPopup.style.marginRight = '15px'; 
    }

      });
      console.error("Error adding product to cart:", error);
    });
  });
});
    
    
// quentity button adjuste


let count = 1;
const countDisplay = document.getElementById('countDisplay');
const incrementBtn = document.getElementById('incrementBtn');
const decrementBtn = document.getElementById('decrementBtn');

function updateDisplay() {
    countDisplay.textContent = count;
}

updateDisplay();

incrementBtn.addEventListener('click', () => {
    if (count < 5) {
        count++;
        updateDisplay();
    }
});

decrementBtn.addEventListener('click', () => {
    if (count > 1) { 
        count--;
        updateDisplay();
    }
});



    
</script>
    
