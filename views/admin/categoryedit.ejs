<!DOCTYPE html>
<html lang="en">
  <%- include("../layouts/admin/admin_header.ejs") %>

  <body>
    <%- include("../layouts/admin/slidbar.ejs") %>

    <main class="main-wrap">
      <%- include("../layouts/admin/navbar.ejs") %> <%-
      include("../layouts/admin/admin_footer.ejs") %>

      <section class="content-main">
        <div class="content-header">
          <div>
            <h2 class="content-title card-title">Edit Categories</h2>
            <br />
            <% if ((errorMessage.length > 0)) { %>
            <div class="alert alert-danger">
              <P><%= errorMessage%></P>
            </div>
            <% } %>
          </div>
        </div>
        <div class="card">
          <div
            class="card-body"
            style="
              display: flex;
              justify-content: center;
              align-items: center;
              height: 100%;
            "
          >
            <div class="col-md-6">
              <form
                action="/edit_cat"
                method="post"
                onsubmit="return validate()"
              >
                <div class="mb-4">
                  <input type="hidden" name="id" value="<%= data._id %>" />

                  <label for="product_name" class="form-label">Name</label>
                  <input
                    name="name"
                    type="text"
                    value="<%= data.name %>"
                    class="form-control"
                    id="catname"
                  />
                  <span id="errorname" class="text-danger"></span>
                </div>
                <div class="mb-4">
                  <label class="form-label">Description</label>
                  <textarea
                    id="catdiscription"
                    name="discription"
                    class="form-control"><%= data.discription %></textarea>
                  <span id="errordis" class="text-danger"></span>
                </div>
                <div class="d-grid">
                  <button type="submit" class="btn btn-primary">
                    Update category
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </section>

      <script>
        function validate() {
          let value = true;
          let nameRegex = /^[a-zA-Z0-9\s]+$/;
          let disRegex = /^[a-zA-Z0-9\s,.!?-]+$/

          let name = document.getElementById("catname").value.trim();
          console.log(name);

          if (name.length < 3 || !nameRegex.test(name)) {
            document.getElementById("errorname").textContent =
              "NAME MUST BE ATLEAST 3 CHARACTERS";
            value = false;
          } else {
            document.getElementById("errorname").textContent = ""; 
          }

          
          let dis = document.getElementById("catdiscription").value.trim();
          console.log(dis);

          if (dis.length < 10 || !disRegex.test(dis)) {
            document.getElementById("errordis").textContent =
              "PLZ ENTER VALID INPUT";
            value = false;
          } else {
            document.getElementById("errordis").textContent = ""; 
          }

          return value;
        }
      </script>
    </main>
    <!-- content-main end// -->
    <script src="assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="assets/js/vendors/select2.min.js"></script>
    <script src="assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="assets/js/vendors/jquery.fullscreen.min.js"></script>
    <script src="assets/js/vendors/chart.js"></script>

    <script src="assets/js/main.js" type="text/javascript"></script>
    <script src="assets/js/custom-chart.js" type="text/javascript"></script>
  </body>
</html>
